# TaskService

## Описание
TaskService API предназначен для взаимодействия с базой данных для задач и предоставляет функционал, реализующий технику Pomodoro для их выполнения.

### техника Pomodoro
Техника Pomodoro подразумевает распределение времени выполнения задачи на фазы работы и перерыва (Стандартные значения - 25 минут работы и 5 минут перерыва).
task-service использует для реализации этой техники Quartz-scheduler, подключаемый в качестве SpringBoot-стартера.

### Описание сущности задачи
Сущность "Task" для задачи содержит следующие аттибуты:

- Long id - уникальный идентификационный номер задачи.
- String name - название задачи.
- String description - описание задачи.
- Status status - статус задачи. Может иметь следующие значения.
    - READY - начальный статус, устанавливающийся при помещении задачи в базу данных.
    - STARTED - таймер запущен и не был поставлен на паузу.
    - PAUSED - таймер поставлен на паузу.
    - RESUMED - таймер возобновлён после паузы.
    - STOPPED - таймер остановлен принудительно.
    - COMPLETE - таймер завершил установленный цикл работы.
- LocalDateTime startDate - дата создания задачи. Устанавливается при помещении задачи в базу данных.
- LocalDateTime stopDate - дата выполнения задачи. Устанавливается при завершении работы Pоmodoro-таймера.
- int workDuration - длительность в секундах фазы работы цикла Pomodoro-таймера.
- int breakDuration - длительность в секундах фазы перерыва цикла Pomodoro-таймера.
- int nCycles - количество повторений цикла Pomodoro-таймера. Таймер прекращает работу по завершении последней фазы работы.
- Long userId - id пользователя, создавшего задачу.

### База данных

PostgresSQL со следующими настройками:
POSTGRES_USER: postgres
POSTGRES_PASSWORD: admin
POSTGRES_DB: postgres

### Интеграция с другими микросервисами

Task-service регистрируется в сервисе eureka-server c именем "task-service".
Доступен через api-gateway по url: "http://localhost:8181/task-service".
Уведомления об обновлении состояния таймера осуществляются посредством KafkaTemplate в топик "pomodoro" в виде enum-объекта Stage с возможными значениями:
- WORK - при начале фазы работы
- BREAK - при начале фазы перерыва
- DONE - при окончании полного цикла Pomodoro.

### Для разработки
PostgresSQL и Kafka для удобства разработки и тестирования можно подключить при помощи файла docker-compose.yml.
При запуске микросервиса в базу данных помещается тестовая задача со следующими параметрами для таймера:
- workDuration = 25
- breakDuration = 5
- nCycles = 2

### Swagger
Описание конечных точек для операций с задачами и Pomodoro-timer доступно по url:
"http://localhost:8080/swagger-ui/index.html".
Для просмотра документации достаточно запустить task-service независимо от других микросервисов.
Предварительно нужно иметь готовую базу данных, для чего достаточно запустить docker-compose.yml (см. предыдущий раздел).